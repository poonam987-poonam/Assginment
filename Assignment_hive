#download the Data file  ----> https://github.com/poonam987-poonam/Assginment/blob/main/sales_order_data.csv
create database hive_class_b1;
show databases;
use hive_class_b1;


 create table sales_order_orc
    > (
    > order_id int,
    > quantity int,
    > price_each float,
    > order_number float,
    > sales float,
    > status string,
    > qtr_id int,
    > month int,
    > year int,
    > product_line string,
    > msrp int,
    > product_code string,
    > phone string,
    > city string,
    > state string,
    > postal_code string,
    > country string,
    > territory string,
    > conatct_last_name string,
    > contact_first_name string,
    > deal_size string
    > )
    > row format delimited
    > fields terminated by ',';

set hive.cli.print.header = true ;

#create directory in HDFS 
$ hadoop fs -mkdir /tmp/data_2

#load data local to HDFS
hadoop fs -put /home/cloudera/data/sales_order_data.csv /tmp/data_2


#load data from hdfs to hive
hive> load data inpath '/tmp/data_2/sales_order_data.csv' into table sales_order_orc ;


#Calculatye total sales per year
hive> select sum(sales) as total_sales ,year from sales_order_orc group by year;
o/p 
2003    3516979.547241211
2004    4724162.593383789
2005    1791486.7086791992

hh
