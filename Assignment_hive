#download the Data file  ----> https://github.com/poonam987-poonam/Assginment/blob/main/sales_order_data.csv
create database hive_class_b1;
show databases;
use hive_class_b1;


 create table sales_order_data
    > (
    > order_id int,
    > quantity int,
    > price_each float,
    > order_number float,
    > sales float,
    > status string,
    > qtr_id int,
    > month int,
    > year int,
    > product_line string,
    > msrp int,
    > product_code string,
    > phone string,
    > city string,
    > state string,
    > postal_code string,
    > country string,
    > territory string,
    > conatct_last_name string,
    > contact_first_name string,
    > deal_size string
    > )
    > row format delimited
    > fields terminated by ','
    >tblproperties("skip.header.line.count"="1");

set hive.cli.print.header = true ;

#create directory in HDFS 
$ hadoop fs -mkdir /tmp/data_2

#load data local to HDFS
hadoop fs -put /home/cloudera/data/sales_order_data.csv /tmp/data_2


#load data from hdfs to hive
hive> load data inpath '/tmp/data_2/sales_order_data.csv' into table sales_order_orc ;


# load sales_order_data.csv data into above mentioned tables
create table sales_order_data_orc
    > (
    > order_id int,
    > quantity int,
    > price_each float,
    > order_number float,
    > sales float,
    > status string,
    > qtr_id int,
    > month int,
    > year int,
    > product_line string,
    > msrp int,
    > product_code string,
    > phone string,
    > city string,
    > state string,
    > postal_code string,
    > country string,
    > territory string,
    > conatct_last_name string,
    > contact_first_name string,
    > deal_size string
    > )
    >stored as orc;
    
    # copy data from sales_order_data to sales_order_data_orc
    insert into table sales_order_data_orc select *from sales_order_data;


a. Calculatye total sales per year
hive> select sum(sales) as total_sales ,year from sales_order_orc group by year;
o/p 
2003    3516979.547241211
2004    4724162.593383789
2005    1791486.7086791992

b. Find a product for which maximum orders were placed

c. Calculate the total sales for each quarter

d. In which quarter sales was minimum
e. In which country sales was maximum and in which country sales was minimum
f. Calculate quartelry sales for each city
h. Find a month for each year in which maximum number of quantities were sold
